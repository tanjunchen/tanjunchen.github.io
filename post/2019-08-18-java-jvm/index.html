<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="漫步远方，心荡神往"><meta property="og:type" content="article"><meta property="og:image" content="https://tanjunchen.github.io/img/home.webp"><meta property="twitter:image" content="https://tanjunchen.github.io/img/home.webp"><meta name=title content="浅析 Java JVM"><meta property="og:title" content="浅析 Java JVM"><meta property="twitter:title" content="浅析 Java JVM"><meta name=description content="俗话说得好，工欲善其事必先利其器，对于Java开发者来说，简单了解Java虚拟机某些特性有益于提升开发者的内功。"><meta property="og:description" content="俗话说得好，工欲善其事必先利其器，对于Java开发者来说，简单了解Java虚拟机某些特性有益于提升开发者的内功。"><meta property="twitter:description" content="俗话说得好，工欲善其事必先利其器，对于Java开发者来说，简单了解Java虚拟机某些特性有益于提升开发者的内功。"><meta property="twitter:card" content="summary"><meta name=keyword content="陈谭军, 互联网, 云原生, 容器, 微服务, Web, PaaS, Istio, Kubernetes, Microservice"><link rel="shortcut icon" href=/img/favicon.ico><title>浅析 Java JVM | 陈谭军的博客 | tanjunchen Blog</title><link rel=canonical href=/post/2019-08-18-java-jvm/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><script src=/js/jquery.min.js></script>
<script src=/js/bootstrap.min.js></script>
<script src=/js/hux-blog.min.js></script>
<script src=/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=/>漫步远方，心荡神往</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/technology/>technology</a></li><li><a href=/categories/think/>think</a></li><li><a href=/learning/>LEARNING</a></li><li><a href=/archive/>ARCHIVE</a></li><li><a href=/about/>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home.webp)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/java title=java>java</a></div><h1>浅析 Java JVM</h1><h2 class=subheading></h2><span class=meta>Posted by
陈谭军
on
Sunday, August 18, 2019
<span id=busuanzi_container_page_pv>|<span id=busuanzi_value_page_pv></span><span>
<span id=/post/2019-08-18-java-jvm/ class="leancloud_visitors meta_data_item" data-flag-title><span class=post-meta-item-icon><span class="octicon octicon-eye"></span></span>
<i class="fa fa-eye"></i>
<span class=old-visitors-count style=display:none></span>
<span class=leancloud-visitors-count></span></span>
<script src=https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js></script>
<script>AV.initialize("","")</script><script type=text/javascript>function showTime(e){var n=new AV.Query(e),t=[],s=$(".leancloud_visitors");s.each(function(){t.push($(this).attr("id").trim())}),n.containedIn("url",t),n.find().done(function(e){for(var s,o,i,a,r,c,l=".leancloud-visitors-count",d=".old-visitors-count",n=0;n<e.length;n++)a=e[n],i=a.get("url"),c=a.get("time"),s=document.getElementById(i),$(s).find(l).text(c);for(n=0;n<t.length;n++)i=t[n],s=document.getElementById(i),o=$(s).find(l),o.text()==""&&(r=$(s).find(d).text(),r!=""?o.text(0+parseInt(r)):o.text(0))}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var n=$(".leancloud_visitors"),t=n.attr("id").trim(),o=n.attr("data-flag-title").trim(),s=new AV.Query(e);s.equalTo("url",t),s.find({success:function(n){if(n.length>0){var s,i,r,c,l,a=n[0];a.fetchWhenSave(!0),a.increment("time"),a.save(null,{success:function(e){var n=$(document.getElementById(t));n.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else s=new e,i=new AV.ACL,i.setPublicReadAccess(!0),i.setPublicWriteAccess(!0),s.setACL(i),s.set("title",o),s.set("url",t),c=".old-visitors-count",l=$(document.getElementById(t)),r=l.find(c).text(),r!=""?s.set("time",parseInt(r)+1):s.set("time",1),s.save(null,{success:function(e){var n=$(document.getElementById(t));n.find(".leancloud-visitors-count").text(e.get("time"))},error:function(){console.log("Failed to create")}})},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");$(".leancloud_visitors").length==1?addCount(e):showTime(e)})</script>阅读 </span></span>|<span class=post-date>共 4058 字</span>，阅读约 <span class=more-meta>9 分钟</span></span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/istio title=istio>istio</a></div></section></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><p>俗话说得好，工欲善其事必先利其器，对于Java开发者来说，简单了解Java虚拟机某些特性有益于提升开发者的内功。为什么我们在编写Java代码前，需要安装并且配置好JDK？JDK内置的这些包功能为什么这么强大？为什么我们的程序会出现内存泄露呢？为什么在代码中加入Synchronized关键字多线程访问程序不会出现数据不一致问题？好多类似的问题，在我们了解JVM之后就会得到答案。要熟悉 Java JVM，大家普遍推荐《深入理解Java虚拟机》周志明著这本书。</p><p>总结 Java JVM 可以归纳为以下几个要点：</p><ol><li>跨平台性：Java JVM是Java语言跨平台的关键技术之一。Java源代码首先被编译成字节码（.class文件），然后在JVM上运行。由于JVM本身是针对不同操作系统和硬件架构进行了优化，所以Java应用程序可以在任何装有对应JVM的平台上运行，无需修改源代码。</li><li>即时编译（Just-In-Time Compilation，JIT）：JVM在运行时使用即时编译器，将字节码转换为本地机器码。这种编译方式在运行时根据代码的执行情况进行优化，可以提高Java应用程序的执行效率。</li><li>内存管理：JVM负责Java应用程序的内存管理。它通过垃圾回收器（Garbage Collector）自动管理内存，使开发人员不必手动分配和释放内存。垃圾回收器会自动回收不再使用的对象，防止内存泄漏。</li><li>安全性：JVM提供了安全管理器（Security Manager），用于控制Java应用程序的访问权限。通过安全管理器，可以限制应用程序对系统资源的访问，从而提供了一个安全的执行环境。</li><li>多线程支持：JVM允许Java应用程序使用多线程来实现并发处理。JVM负责线程的创建、同步和销毁，使得开发人员能够更方便地编写多线程程序。</li><li>性能监控和调优：JVM提供了丰富的性能监控和调优工具，帮助开发人员识别和解决性能瓶颈。通过这些工具，可以监控内存使用情况、线程状态、垃圾回收等信息，从而优化Java应用程序的性能。</li></ol><p>JVM 主要组成部分：
<img src=/images/2019-08-18-java-jvm/1.jpeg alt></p><p>我们首先看段代码，如下所示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>happenBeforeDemo</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd>int</span> value <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>int</span> <span style=color:#50fa7b>getValue</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> value<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>setValue</span><span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> value<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>value</span> <span style=color:#ff79c6>=</span> value<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>String<span style=color:#ff79c6>[]</span> args<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        happenBeforeDemo happenBeforeDemo <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> happenBeforeDemo<span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>new</span> Thread<span style=color:#ff79c6>(()</span> <span style=color:#ff79c6>-&gt;</span> happenBeforeDemo<span style=color:#ff79c6>.</span><span style=color:#50fa7b>setValue</span><span style=color:#ff79c6>(</span>22<span style=color:#ff79c6>)).</span><span style=color:#50fa7b>start</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>new</span> Thread<span style=color:#ff79c6>(()</span> <span style=color:#ff79c6>-&gt;</span> System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>happenBeforeDemo<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getValue</span><span style=color:#ff79c6>())).</span><span style=color:#50fa7b>start</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>大家猜测下输出的结果是什么？0 还是 1？而这段代码遵循的是什么原则？先行并发原则是什么？<br><em><strong>衡量线程安全性问题 不要受时间顺序的干扰 而是一切以先行发生原则为基准</strong></em><br><em><strong>程序次序规则 管程锁定规则 volatile变量规则 线程启动规则 线程终止规则 线程中断规则 对象终结规则 传递性</strong></em></p><p>由于第一个线程和第二个线程分别调用 setValue() 和 getValue() 两个函数,不在同一个线程中，程序次序规则不适用，由于没有同步块则自然不会发生 lock 操作与 unlock 操作，线程锁定不适合。由于 value 没有添加 volatile 修饰，自然就没有 volatile 变量规则，后面的线程启动，线程终止，线程中断，对象终结规则也和这里没有关系。最后一条传递性也不适用。所以该操作为线程不安全操作。解决方案也比较常见，使用 synchronized 与 volatile 保证上述原则。我们知道这段代码最终会编译成 .class 文件，在我们查看字节码之前，先了解下以下简单的知识。字节码的格式说明：</p><p><img src=/images/2019-08-18-java-jvm/2.jpeg alt></p><ol><li>魔术与 Class 文件的版本</li><li>常量池</li><li>访问标志</li><li>类索引父索引与接口索引集合</li><li>字段表集合</li><li>方法表集合</li><li>属性表集合（1code 2Exceptions 3 LineNumberTable 4LocalVariableTable 5 SourceFile属性 6ConstantValue属性 7 InnerClasses）</li><li>Deprecated 以及 Synthetic 属性</li><li>StackMapTable 属性(JDK1.6 后加的)</li><li>Signature 属性(JDK1.5 后加的)</li><li>BootstrapMethods 属性(JDK1.7 后加的)</li></ol><p>Java 版本与符号列表如下所示：</p><table><thead><tr><th>版本</th><th>符号</th></tr></thead><tbody><tr><td>Java 1.2</td><td>0x002E=46</td></tr><tr><td>Java 1.3</td><td>0x002F=47</td></tr><tr><td>Java 1.4</td><td>0x0030=48</td></tr><tr><td>Java 5</td><td>0x0031=49</td></tr><tr><td>Java 6</td><td>0x0032=50</td></tr><tr><td>Java 7</td><td>0x0033=51</td></tr><tr><td>Java 8</td><td>0x0034=52</td></tr></tbody></table><p>常量池 00 81 128 2个字节，从1开始，0另有所用，u2类型也就是2个字节，最大值 65535。Java 中如果出现超过 64KB 英文字符的遍历或者方法名，将会无法编译，访问标志：2个字节 0A 00。</p><pre tabindex=0><code>CONSTANT_Methodref_info {u1 tag; u2 class_index;u2 name_and_type_index;}
Tag 10    class_index   30
</code></pre><p><img src=/images/2019-08-18-java-jvm/3.jpeg alt>
CONSTANT_Utf8_info 示例说明：
<img src=/images/2019-08-18-java-jvm/4.jpeg alt>
<img src=/images/2019-08-18-java-jvm/5.jpeg alt></p><p>这样常量池的 21 个常量全部分析完毕，不过 JDK 提供了一个方便的工具可以让我们查看常量池中所包含的常量。通过 javap -verbose TestClass 即可得到所有常量池中的常量，如下所示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Classfile <span style=color:#ff79c6>/</span>F<span style=color:#ff79c6>:/</span>AllLearnDemo<span style=color:#ff79c6>/</span>target<span style=color:#ff79c6>/</span>classes<span style=color:#ff79c6>/</span>ctj<span style=color:#ff79c6>/</span>jvm<span style=color:#ff79c6>/</span>VolatileDemo<span style=color:#ff79c6>.</span><span style=color:#50fa7b>class</span>
</span></span><span style=display:flex><span>  Last modified Apr 28<span style=color:#ff79c6>,</span> 2019<span style=color:#ff79c6>;</span> size 2191 bytes
</span></span><span style=display:flex><span>  MD5 checksum 4b8bdbdb19c2d903e032c4216643bcd5
</span></span><span style=display:flex><span>  Compiled from <span style=color:#f1fa8c>&#34;VolatileDemo.java&#34;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>ctj</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>jvm</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>VolatileDemo</span>
</span></span><span style=display:flex><span>  minor version<span style=color:#ff79c6>:</span> 0
</span></span><span style=display:flex><span>  major version<span style=color:#ff79c6>:</span> 52
</span></span><span style=display:flex><span>  flags<span style=color:#ff79c6>:</span> ACC_PUBLIC<span style=color:#ff79c6>,</span> ACC_SUPER<span style=color:#ff79c6>(</span>解释：ACC_PUBLIC大家好理解  ACC_SUPER是jdk1<span style=color:#ff79c6>.</span><span style=color:#50fa7b>0</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>2之后编译的类都会带有的标志</span><span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>Constant pool<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>    #1 <span style=color:#ff79c6>=</span> Methodref          #30<span style=color:#ff79c6>.</span>#66       <span style=color:#6272a4>// java/lang/Object.&#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #2 <span style=color:#ff79c6>=</span> Class              #67           <span style=color:#6272a4>// java/lang/Thread
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #3 <span style=color:#ff79c6>=</span> Class              #68           <span style=color:#6272a4>// ctj/jvm/VolatileDemo$1
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #4 <span style=color:#ff79c6>=</span> Methodref          #3<span style=color:#ff79c6>.</span>#66        <span style=color:#6272a4>// ctj/jvm/VolatileDemo$1.&#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #5 <span style=color:#ff79c6>=</span> Methodref          #2<span style=color:#ff79c6>.</span>#69        <span style=color:#6272a4>// java/lang/Thread.&#34;&lt;init&gt;&#34;:(Ljava/lang/Runnable;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #6 <span style=color:#ff79c6>=</span> Methodref          #2<span style=color:#ff79c6>.</span>#70        <span style=color:#6272a4>// java/lang/Thread.start:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #7 <span style=color:#ff79c6>=</span> Fieldref           #71<span style=color:#ff79c6>.</span>#72       <span style=color:#6272a4>// java/lang/System.out:Ljava/io/PrintStream;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #8 <span style=color:#ff79c6>=</span> Methodref          #2<span style=color:#ff79c6>.</span>#73        <span style=color:#6272a4>// java/lang/Thread.getName:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>    #9 <span style=color:#ff79c6>=</span> Methodref          #74<span style=color:#ff79c6>.</span>#75       <span style=color:#6272a4>// java/io/PrintStream.println:(Ljava/lang/String;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #10 <span style=color:#ff79c6>=</span> Methodref          #2<span style=color:#ff79c6>.</span>#76        <span style=color:#6272a4>// java/lang/Thread.activeCount:()I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #11 <span style=color:#ff79c6>=</span> Methodref          #2<span style=color:#ff79c6>.</span>#77        <span style=color:#6272a4>// java/lang/Thread.yield:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #12 <span style=color:#ff79c6>=</span> Methodref          #78<span style=color:#ff79c6>.</span>#79       <span style=color:#6272a4>// java/lang/management/ManagementFactory.getThreadMXBean:()Ljava/lang/management/ThreadMXBean;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #13 <span style=color:#ff79c6>=</span> InterfaceMethodref #80<span style=color:#ff79c6>.</span>#81       <span style=color:#6272a4>// java/lang/management/ThreadMXBean.dumpAllThreads:(ZZ)[Ljava/lang/management/ThreadInfo;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #14 <span style=color:#ff79c6>=</span> Class              #82           <span style=color:#6272a4>// java/lang/StringBuilder
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #15 <span style=color:#ff79c6>=</span> Methodref          #14<span style=color:#ff79c6>.</span>#66       <span style=color:#6272a4>// java/lang/StringBuilder.&#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #16 <span style=color:#ff79c6>=</span> String             #83           <span style=color:#6272a4>// [
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #17 <span style=color:#ff79c6>=</span> Methodref          #14<span style=color:#ff79c6>.</span>#84       <span style=color:#6272a4>// java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #18 <span style=color:#ff79c6>=</span> Methodref          #85<span style=color:#ff79c6>.</span>#86       <span style=color:#6272a4>// java/lang/management/ThreadInfo.getThreadId:()J
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #19 <span style=color:#ff79c6>=</span> Methodref          #14<span style=color:#ff79c6>.</span>#87       <span style=color:#6272a4>// java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #20 <span style=color:#ff79c6>=</span> String             #88           <span style=color:#6272a4>// ]
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #21 <span style=color:#ff79c6>=</span> Methodref          #85<span style=color:#ff79c6>.</span>#89       <span style=color:#6272a4>// java/lang/management/ThreadInfo.getThreadName:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #22 <span style=color:#ff79c6>=</span> Methodref          #14<span style=color:#ff79c6>.</span>#90       <span style=color:#6272a4>// java/lang/StringBuilder.toString:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #23 <span style=color:#ff79c6>=</span> Fieldref           #29<span style=color:#ff79c6>.</span>#91       <span style=color:#6272a4>// ctj/jvm/VolatileDemo.raceB:Ljava/util/concurrent/atomic/AtomicInteger;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #24 <span style=color:#ff79c6>=</span> Methodref          #74<span style=color:#ff79c6>.</span>#92       <span style=color:#6272a4>// java/io/PrintStream.println:(Ljava/lang/Object;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #25 <span style=color:#ff79c6>=</span> Fieldref           #29<span style=color:#ff79c6>.</span>#93       <span style=color:#6272a4>// ctj/jvm/VolatileDemo.race:I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #26 <span style=color:#ff79c6>=</span> Methodref          #27<span style=color:#ff79c6>.</span>#94       <span style=color:#6272a4>// java/util/concurrent/atomic/AtomicInteger.incrementAndGet:()I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #27 <span style=color:#ff79c6>=</span> Class              #95           <span style=color:#6272a4>// java/util/concurrent/atomic/AtomicInteger
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #28 <span style=color:#ff79c6>=</span> Methodref          #27<span style=color:#ff79c6>.</span>#96       <span style=color:#6272a4>// java/util/concurrent/atomic/AtomicInteger.&#34;&lt;init&gt;&#34;:(I)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #29 <span style=color:#ff79c6>=</span> Class              #97           <span style=color:#6272a4>// ctj/jvm/VolatileDemo
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #30 <span style=color:#ff79c6>=</span> Class              #98           <span style=color:#6272a4>// java/lang/Object
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #31 <span style=color:#ff79c6>=</span> Utf8               InnerClasses
</span></span><span style=display:flex><span>   #32 <span style=color:#ff79c6>=</span> Utf8               race
</span></span><span style=display:flex><span>   #33 <span style=color:#ff79c6>=</span> Utf8               I
</span></span><span style=display:flex><span>   #34 <span style=color:#ff79c6>=</span> Utf8               raceB
</span></span><span style=display:flex><span>   #35 <span style=color:#ff79c6>=</span> Utf8               Ljava<span style=color:#ff79c6>/</span>util<span style=color:#ff79c6>/</span>concurrent<span style=color:#ff79c6>/</span>atomic<span style=color:#ff79c6>/</span>AtomicInteger<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #36 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>&lt;</span>init<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>   #37 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>()</span>V
</span></span><span style=display:flex><span>   #38 <span style=color:#ff79c6>=</span> Utf8               Code
</span></span><span style=display:flex><span>   #39 <span style=color:#ff79c6>=</span> Utf8               LineNumberTable
</span></span><span style=display:flex><span>   #40 <span style=color:#ff79c6>=</span> Utf8               LocalVariableTable
</span></span><span style=display:flex><span>   #41 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>this</span>
</span></span><span style=display:flex><span>   #42 <span style=color:#ff79c6>=</span> Utf8               Lctj<span style=color:#ff79c6>/</span>jvm<span style=color:#ff79c6>/</span>VolatileDemo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #43 <span style=color:#ff79c6>=</span> Utf8               main
</span></span><span style=display:flex><span>   #44 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>([</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;)</span>V
</span></span><span style=display:flex><span>   #45 <span style=color:#ff79c6>=</span> Utf8               i
</span></span><span style=display:flex><span>   #46 <span style=color:#ff79c6>=</span> Utf8               info
</span></span><span style=display:flex><span>   #47 <span style=color:#ff79c6>=</span> Utf8               Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #48 <span style=color:#ff79c6>=</span> Utf8               args
</span></span><span style=display:flex><span>   #49 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #50 <span style=color:#ff79c6>=</span> Utf8               threads
</span></span><span style=display:flex><span>   #51 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Thread<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #52 <span style=color:#ff79c6>=</span> Utf8               threadMXBean
</span></span><span style=display:flex><span>   #53 <span style=color:#ff79c6>=</span> Utf8               Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadMXBean<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #54 <span style=color:#ff79c6>=</span> Utf8               threadInfo
</span></span><span style=display:flex><span>   #55 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>   #56 <span style=color:#ff79c6>=</span> Utf8               StackMapTable
</span></span><span style=display:flex><span>   #57 <span style=color:#ff79c6>=</span> Class              #51           <span style=color:#6272a4>// &#34;[Ljava/lang/Thread;&#34;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #58 <span style=color:#ff79c6>=</span> Class              #49           <span style=color:#6272a4>// &#34;[Ljava/lang/String;&#34;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #59 <span style=color:#ff79c6>=</span> Class              #99           <span style=color:#6272a4>// java/lang/management/ThreadMXBean
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #60 <span style=color:#ff79c6>=</span> Class              #55           <span style=color:#6272a4>// &#34;[Ljava/lang/management/ThreadInfo;&#34;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #61 <span style=color:#ff79c6>=</span> Utf8               increase
</span></span><span style=display:flex><span>   #62 <span style=color:#ff79c6>=</span> Utf8               increaseB
</span></span><span style=display:flex><span>   #63 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>&lt;</span>clinit<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>   #64 <span style=color:#ff79c6>=</span> Utf8               SourceFile
</span></span><span style=display:flex><span>   #65 <span style=color:#ff79c6>=</span> Utf8               VolatileDemo<span style=color:#ff79c6>.</span><span style=color:#50fa7b>java</span>
</span></span><span style=display:flex><span>   #66 <span style=color:#ff79c6>=</span> NameAndType        #36<span style=color:#ff79c6>:</span>#37       <span style=color:#6272a4>// &#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #67 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Thread
</span></span><span style=display:flex><span>   #68 <span style=color:#ff79c6>=</span> Utf8               ctj<span style=color:#ff79c6>/</span>jvm<span style=color:#ff79c6>/</span>VolatileDemo$1
</span></span><span style=display:flex><span>   #69 <span style=color:#ff79c6>=</span> NameAndType        #36<span style=color:#ff79c6>:</span>#100      <span style=color:#6272a4>// &#34;&lt;init&gt;&#34;:(Ljava/lang/Runnable;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #70 <span style=color:#ff79c6>=</span> NameAndType        #101<span style=color:#ff79c6>:</span>#37      <span style=color:#6272a4>// start:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #71 <span style=color:#ff79c6>=</span> Class              #102          <span style=color:#6272a4>// java/lang/System
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #72 <span style=color:#ff79c6>=</span> NameAndType        #103<span style=color:#ff79c6>:</span>#104     <span style=color:#6272a4>// out:Ljava/io/PrintStream;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #73 <span style=color:#ff79c6>=</span> NameAndType        #105<span style=color:#ff79c6>:</span>#106     <span style=color:#6272a4>// getName:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #74 <span style=color:#ff79c6>=</span> Class              #107          <span style=color:#6272a4>// java/io/PrintStream
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #75 <span style=color:#ff79c6>=</span> NameAndType        #108<span style=color:#ff79c6>:</span>#109     <span style=color:#6272a4>// println:(Ljava/lang/String;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #76 <span style=color:#ff79c6>=</span> NameAndType        #110<span style=color:#ff79c6>:</span>#111     <span style=color:#6272a4>// activeCount:()I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #77 <span style=color:#ff79c6>=</span> NameAndType        #112<span style=color:#ff79c6>:</span>#37      <span style=color:#6272a4>// yield:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #78 <span style=color:#ff79c6>=</span> Class              #113          <span style=color:#6272a4>// java/lang/management/ManagementFactory
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #79 <span style=color:#ff79c6>=</span> NameAndType        #114<span style=color:#ff79c6>:</span>#115     <span style=color:#6272a4>// getThreadMXBean:()Ljava/lang/management/ThreadMXBean;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #80 <span style=color:#ff79c6>=</span> Class              #99           <span style=color:#6272a4>// java/lang/management/ThreadMXBean
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #81 <span style=color:#ff79c6>=</span> NameAndType        #116<span style=color:#ff79c6>:</span>#117     <span style=color:#6272a4>// dumpAllThreads:(ZZ)[Ljava/lang/management/ThreadInfo;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #82 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>StringBuilder
</span></span><span style=display:flex><span>   #83 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>[</span>
</span></span><span style=display:flex><span>   #84 <span style=color:#ff79c6>=</span> NameAndType        #118<span style=color:#ff79c6>:</span>#119     <span style=color:#6272a4>// append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #85 <span style=color:#ff79c6>=</span> Class              #120          <span style=color:#6272a4>// java/lang/management/ThreadInfo
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #86 <span style=color:#ff79c6>=</span> NameAndType        #121<span style=color:#ff79c6>:</span>#122     <span style=color:#6272a4>// getThreadId:()J
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #87 <span style=color:#ff79c6>=</span> NameAndType        #118<span style=color:#ff79c6>:</span>#123     <span style=color:#6272a4>// append:(J)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #88 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>]</span>
</span></span><span style=display:flex><span>   #89 <span style=color:#ff79c6>=</span> NameAndType        #124<span style=color:#ff79c6>:</span>#106     <span style=color:#6272a4>// getThreadName:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #90 <span style=color:#ff79c6>=</span> NameAndType        #125<span style=color:#ff79c6>:</span>#106     <span style=color:#6272a4>// toString:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #91 <span style=color:#ff79c6>=</span> NameAndType        #34<span style=color:#ff79c6>:</span>#35       <span style=color:#6272a4>// raceB:Ljava/util/concurrent/atomic/AtomicInteger;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #92 <span style=color:#ff79c6>=</span> NameAndType        #108<span style=color:#ff79c6>:</span>#126     <span style=color:#6272a4>// println:(Ljava/lang/Object;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #93 <span style=color:#ff79c6>=</span> NameAndType        #32<span style=color:#ff79c6>:</span>#33       <span style=color:#6272a4>// race:I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #94 <span style=color:#ff79c6>=</span> NameAndType        #127<span style=color:#ff79c6>:</span>#111     <span style=color:#6272a4>// incrementAndGet:()I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #95 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>util<span style=color:#ff79c6>/</span>concurrent<span style=color:#ff79c6>/</span>atomic<span style=color:#ff79c6>/</span>AtomicInteger
</span></span><span style=display:flex><span>   #96 <span style=color:#ff79c6>=</span> NameAndType        #36<span style=color:#ff79c6>:</span>#128      <span style=color:#6272a4>// &#34;&lt;init&gt;&#34;:(I)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>   #97 <span style=color:#ff79c6>=</span> Utf8               ctj<span style=color:#ff79c6>/</span>jvm<span style=color:#ff79c6>/</span>VolatileDemo
</span></span><span style=display:flex><span>   #98 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Object
</span></span><span style=display:flex><span>   #99 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadMXBean
</span></span><span style=display:flex><span>  #100 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Runnable<span style=color:#ff79c6>;)</span>V
</span></span><span style=display:flex><span>  #101 <span style=color:#ff79c6>=</span> Utf8               start
</span></span><span style=display:flex><span>  #102 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>System
</span></span><span style=display:flex><span>  #103 <span style=color:#ff79c6>=</span> Utf8               out
</span></span><span style=display:flex><span>  #104 <span style=color:#ff79c6>=</span> Utf8               Ljava<span style=color:#ff79c6>/</span>io<span style=color:#ff79c6>/</span>PrintStream<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>  #105 <span style=color:#ff79c6>=</span> Utf8               getName
</span></span><span style=display:flex><span>  #106 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>()</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>  #107 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>io<span style=color:#ff79c6>/</span>PrintStream
</span></span><span style=display:flex><span>  #108 <span style=color:#ff79c6>=</span> Utf8               println
</span></span><span style=display:flex><span>  #109 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;)</span>V
</span></span><span style=display:flex><span>  #110 <span style=color:#ff79c6>=</span> Utf8               activeCount
</span></span><span style=display:flex><span>  #111 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>()</span>I
</span></span><span style=display:flex><span>  #112 <span style=color:#ff79c6>=</span> Utf8               yield
</span></span><span style=display:flex><span>  #113 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ManagementFactory
</span></span><span style=display:flex><span>  #114 <span style=color:#ff79c6>=</span> Utf8               getThreadMXBean
</span></span><span style=display:flex><span>  #115 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>()</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadMXBean<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>  #116 <span style=color:#ff79c6>=</span> Utf8               dumpAllThreads
</span></span><span style=display:flex><span>  #117 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>ZZ<span style=color:#ff79c6>)[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>  #118 <span style=color:#ff79c6>=</span> Utf8               append
</span></span><span style=display:flex><span>  #119 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;)</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>StringBuilder<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>  #120 <span style=color:#ff79c6>=</span> Utf8               java<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo
</span></span><span style=display:flex><span>  #121 <span style=color:#ff79c6>=</span> Utf8               getThreadId
</span></span><span style=display:flex><span>  #122 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>()</span>J
</span></span><span style=display:flex><span>  #123 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>J<span style=color:#ff79c6>)</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>StringBuilder<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>  #124 <span style=color:#ff79c6>=</span> Utf8               getThreadName
</span></span><span style=display:flex><span>  #125 <span style=color:#ff79c6>=</span> Utf8               toString
</span></span><span style=display:flex><span>  #126 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Object<span style=color:#ff79c6>;)</span>V
</span></span><span style=display:flex><span>  #127 <span style=color:#ff79c6>=</span> Utf8               incrementAndGet
</span></span><span style=display:flex><span>  #128 <span style=color:#ff79c6>=</span> Utf8               <span style=color:#ff79c6>(</span>I<span style=color:#ff79c6>)</span>V
</span></span><span style=display:flex><span><span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>  <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd;font-style:italic>volatile</span> <span style=color:#8be9fd>int</span> race<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    descriptor<span style=color:#ff79c6>:</span> I
</span></span><span style=display:flex><span>    flags<span style=color:#ff79c6>:</span> ACC_PUBLIC<span style=color:#ff79c6>,</span> ACC_STATIC<span style=color:#ff79c6>,</span> ACC_VOLATILE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> java<span style=color:#ff79c6>.</span><span style=color:#50fa7b>util</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>concurrent</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>atomic</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>AtomicInteger</span> raceB<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    descriptor<span style=color:#ff79c6>:</span> Ljava<span style=color:#ff79c6>/</span>util<span style=color:#ff79c6>/</span>concurrent<span style=color:#ff79c6>/</span>atomic<span style=color:#ff79c6>/</span>AtomicInteger<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    flags<span style=color:#ff79c6>:</span> ACC_PUBLIC<span style=color:#ff79c6>,</span> ACC_STATIC
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8be9fd;font-style:italic>public</span> ctj<span style=color:#ff79c6>.</span><span style=color:#50fa7b>jvm</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>VolatileDemo</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>    descriptor<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>()</span>V
</span></span><span style=display:flex><span>    flags<span style=color:#ff79c6>:</span> ACC_PUBLIC
</span></span><span style=display:flex><span>    Code<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>      stack<span style=color:#ff79c6>=</span>1<span style=color:#ff79c6>,</span> locals<span style=color:#ff79c6>=</span>1<span style=color:#ff79c6>,</span> args_size<span style=color:#ff79c6>=</span>1
</span></span><span style=display:flex><span>         0<span style=color:#ff79c6>:</span> aload_0
</span></span><span style=display:flex><span>         1<span style=color:#ff79c6>:</span> invokespecial #1                  <span style=color:#6272a4>// Method java/lang/Object.&#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>         4<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>return</span>
</span></span><span style=display:flex><span>      LineNumberTable<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>        line 8<span style=color:#ff79c6>:</span> 0
</span></span><span style=display:flex><span>      LocalVariableTable<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>        Start  Length  Slot  Name   Signature
</span></span><span style=display:flex><span>            0       5     0  <span style=color:#ff79c6>this</span>   Lctj<span style=color:#ff79c6>/</span>jvm<span style=color:#ff79c6>/</span>VolatileDemo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>java<span style=color:#ff79c6>.</span><span style=color:#50fa7b>lang</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>String</span><span style=color:#ff79c6>[]);</span>
</span></span><span style=display:flex><span>    descriptor<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>([</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;)</span>V
</span></span><span style=display:flex><span>    flags<span style=color:#ff79c6>:</span> ACC_PUBLIC<span style=color:#ff79c6>,</span> ACC_STATIC
</span></span><span style=display:flex><span>    Code<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>      stack<span style=color:#ff79c6>=</span>6<span style=color:#ff79c6>,</span> locals<span style=color:#ff79c6>=</span>8<span style=color:#ff79c6>,</span> args_size<span style=color:#ff79c6>=</span>1  <span style=color:#ff79c6>(</span>类似汇编写法<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>         0<span style=color:#ff79c6>:</span> bipush        10
</span></span><span style=display:flex><span>         2<span style=color:#ff79c6>:</span> anewarray     #2                  <span style=color:#6272a4>// class java/lang/Thread
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>         5<span style=color:#ff79c6>:</span> astore_1
</span></span><span style=display:flex><span>         6<span style=color:#ff79c6>:</span> iconst_0
</span></span><span style=display:flex><span>         7<span style=color:#ff79c6>:</span> istore_2
</span></span><span style=display:flex><span>         8<span style=color:#ff79c6>:</span> iload_2
</span></span><span style=display:flex><span>         9<span style=color:#ff79c6>:</span> aload_1
</span></span><span style=display:flex><span>        10<span style=color:#ff79c6>:</span> arraylength
</span></span><span style=display:flex><span>        11<span style=color:#ff79c6>:</span> if_icmpge     55
</span></span><span style=display:flex><span>        14<span style=color:#ff79c6>:</span> aload_1
</span></span><span style=display:flex><span>        15<span style=color:#ff79c6>:</span> iload_2
</span></span><span style=display:flex><span>        16<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>new</span>           #2                  <span style=color:#6272a4>// class java/lang/Thread
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        19<span style=color:#ff79c6>:</span> dup
</span></span><span style=display:flex><span>        20<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>new</span>           #3                  <span style=color:#6272a4>// class ctj/jvm/VolatileDemo$1
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        23<span style=color:#ff79c6>:</span> dup
</span></span><span style=display:flex><span>        24<span style=color:#ff79c6>:</span> invokespecial #4                  <span style=color:#6272a4>// Method ctj/jvm/VolatileDemo$1.&#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        27<span style=color:#ff79c6>:</span> invokespecial #5                  <span style=color:#6272a4>// Method java/lang/Thread.&#34;&lt;init&gt;&#34;:(Ljava/lang/Runnable;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        30<span style=color:#ff79c6>:</span> aastore
</span></span><span style=display:flex><span>        31<span style=color:#ff79c6>:</span> aload_1
</span></span><span style=display:flex><span>        32<span style=color:#ff79c6>:</span> iload_2
</span></span><span style=display:flex><span>        33<span style=color:#ff79c6>:</span> aaload
</span></span><span style=display:flex><span>        34<span style=color:#ff79c6>:</span> invokevirtual #6                  <span style=color:#6272a4>// Method java/lang/Thread.start:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        37<span style=color:#ff79c6>:</span> getstatic     #7                  <span style=color:#6272a4>// Field java/lang/System.out:Ljava/io/PrintStream;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        40<span style=color:#ff79c6>:</span> aload_1
</span></span><span style=display:flex><span>        41<span style=color:#ff79c6>:</span> iload_2
</span></span><span style=display:flex><span>        42<span style=color:#ff79c6>:</span> aaload
</span></span><span style=display:flex><span>        43<span style=color:#ff79c6>:</span> invokevirtual #8                  <span style=color:#6272a4>// Method java/lang/Thread.getName:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        46<span style=color:#ff79c6>:</span> invokevirtual #9                  <span style=color:#6272a4>// Method java/io/PrintStream.println:(Ljava/lang/String;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        49<span style=color:#ff79c6>:</span> iinc          2<span style=color:#ff79c6>,</span> 1
</span></span><span style=display:flex><span>        52<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>goto</span>          8
</span></span><span style=display:flex><span>        55<span style=color:#ff79c6>:</span> invokestatic  #10                 <span style=color:#6272a4>// Method java/lang/Thread.activeCount:()I
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        58<span style=color:#ff79c6>:</span> iconst_2
</span></span><span style=display:flex><span>        59<span style=color:#ff79c6>:</span> if_icmple     68
</span></span><span style=display:flex><span>        62<span style=color:#ff79c6>:</span> invokestatic  #11                 <span style=color:#6272a4>// Method java/lang/Thread.yield:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        65<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>goto</span>          55
</span></span><span style=display:flex><span>        68<span style=color:#ff79c6>:</span> invokestatic  #12                 <span style=color:#6272a4>// Method java/lang/management/ManagementFactory.getThreadMXBean:()Ljava/lang/management/ThreadMXBean;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        71<span style=color:#ff79c6>:</span> astore_2
</span></span><span style=display:flex><span>        72<span style=color:#ff79c6>:</span> aload_2
</span></span><span style=display:flex><span>        73<span style=color:#ff79c6>:</span> iconst_0
</span></span><span style=display:flex><span>        74<span style=color:#ff79c6>:</span> iconst_0
</span></span><span style=display:flex><span>        75<span style=color:#ff79c6>:</span> invokeinterface #13<span style=color:#ff79c6>,</span>  3           <span style=color:#6272a4>// InterfaceMethod java/lang/management/ThreadMXBean.dumpAllThreads:(ZZ)[Ljava/lang/management/ThreadInfo;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        80<span style=color:#ff79c6>:</span> astore_3
</span></span><span style=display:flex><span>        81<span style=color:#ff79c6>:</span> aload_3
</span></span><span style=display:flex><span>        82<span style=color:#ff79c6>:</span> astore        4
</span></span><span style=display:flex><span>        84<span style=color:#ff79c6>:</span> aload         4
</span></span><span style=display:flex><span>        86<span style=color:#ff79c6>:</span> arraylength
</span></span><span style=display:flex><span>        87<span style=color:#ff79c6>:</span> istore        5
</span></span><span style=display:flex><span>        89<span style=color:#ff79c6>:</span> iconst_0
</span></span><span style=display:flex><span>        90<span style=color:#ff79c6>:</span> istore        6
</span></span><span style=display:flex><span>        92<span style=color:#ff79c6>:</span> iload         6
</span></span><span style=display:flex><span>        94<span style=color:#ff79c6>:</span> iload         5
</span></span><span style=display:flex><span>        96<span style=color:#ff79c6>:</span> if_icmpge     154
</span></span><span style=display:flex><span>        99<span style=color:#ff79c6>:</span> aload         4
</span></span><span style=display:flex><span>       101<span style=color:#ff79c6>:</span> iload         6
</span></span><span style=display:flex><span>       103<span style=color:#ff79c6>:</span> aaload
</span></span><span style=display:flex><span>       104<span style=color:#ff79c6>:</span> astore        7
</span></span><span style=display:flex><span>       106<span style=color:#ff79c6>:</span> getstatic     #7                  <span style=color:#6272a4>// Field java/lang/System.out:Ljava/io/PrintStream;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       109<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>new</span>           #14                 <span style=color:#6272a4>// class java/lang/StringBuilder
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       112<span style=color:#ff79c6>:</span> dup
</span></span><span style=display:flex><span>       113<span style=color:#ff79c6>:</span> invokespecial #15                 <span style=color:#6272a4>// Method java/lang/StringBuilder.&#34;&lt;init&gt;&#34;:()V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       116<span style=color:#ff79c6>:</span> ldc           #16                 <span style=color:#6272a4>// String [
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       118<span style=color:#ff79c6>:</span> invokevirtual #17                 <span style=color:#6272a4>// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       121<span style=color:#ff79c6>:</span> aload         7
</span></span><span style=display:flex><span>       123<span style=color:#ff79c6>:</span> invokevirtual #18                 <span style=color:#6272a4>// Method java/lang/management/ThreadInfo.getThreadId:()J
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       126<span style=color:#ff79c6>:</span> invokevirtual #19                 <span style=color:#6272a4>// Method java/lang/StringBuilder.append:(J)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       129<span style=color:#ff79c6>:</span> ldc           #20                 <span style=color:#6272a4>// String ]
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       131<span style=color:#ff79c6>:</span> invokevirtual #17                 <span style=color:#6272a4>// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       134<span style=color:#ff79c6>:</span> aload         7
</span></span><span style=display:flex><span>       136<span style=color:#ff79c6>:</span> invokevirtual #21                 <span style=color:#6272a4>// Method java/lang/management/ThreadInfo.getThreadName:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       139<span style=color:#ff79c6>:</span> invokevirtual #17                 <span style=color:#6272a4>// Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       142<span style=color:#ff79c6>:</span> invokevirtual #22                 <span style=color:#6272a4>// Method java/lang/StringBuilder.toString:()Ljava/lang/String;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       145<span style=color:#ff79c6>:</span> invokevirtual #9                  <span style=color:#6272a4>// Method java/io/PrintStream.println:(Ljava/lang/String;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       148<span style=color:#ff79c6>:</span> iinc          6<span style=color:#ff79c6>,</span> 1
</span></span><span style=display:flex><span>       151<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>goto</span>          92
</span></span><span style=display:flex><span>       154<span style=color:#ff79c6>:</span> getstatic     #7                  <span style=color:#6272a4>// Field java/lang/System.out:Ljava/io/PrintStream;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       157<span style=color:#ff79c6>:</span> getstatic     #23                 <span style=color:#6272a4>// Field raceB:Ljava/util/concurrent/atomic/AtomicInteger;
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       160<span style=color:#ff79c6>:</span> invokevirtual #24                 <span style=color:#6272a4>// Method java/io/PrintStream.println:(Ljava/lang/Object;)V
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>       163<span style=color:#ff79c6>:</span> <span style=color:#ff79c6>return</span>
</span></span><span style=display:flex><span>      LineNumberTable<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>        line 16<span style=color:#ff79c6>:</span> 0
</span></span><span style=display:flex><span>        line 17<span style=color:#ff79c6>:</span> 6
</span></span><span style=display:flex><span>        line 18<span style=color:#ff79c6>:</span> 14
</span></span><span style=display:flex><span>        line 26<span style=color:#ff79c6>:</span> 31
</span></span><span style=display:flex><span>        line 27<span style=color:#ff79c6>:</span> 37
</span></span><span style=display:flex><span>        line 17<span style=color:#ff79c6>:</span> 49
</span></span><span style=display:flex><span>        line 29<span style=color:#ff79c6>:</span> 55
</span></span><span style=display:flex><span>        line 30<span style=color:#ff79c6>:</span> 62
</span></span><span style=display:flex><span>        line 32<span style=color:#ff79c6>:</span> 68
</span></span><span style=display:flex><span>        line 33<span style=color:#ff79c6>:</span> 72
</span></span><span style=display:flex><span>        line 34<span style=color:#ff79c6>:</span> 81
</span></span><span style=display:flex><span>        line 35<span style=color:#ff79c6>:</span> 106
</span></span><span style=display:flex><span>        line 34<span style=color:#ff79c6>:</span> 148
</span></span><span style=display:flex><span>        line 37<span style=color:#ff79c6>:</span> 154
</span></span><span style=display:flex><span>        line 38<span style=color:#ff79c6>:</span> 163
</span></span><span style=display:flex><span>      LocalVariableTable<span style=color:#ff79c6>:</span>
</span></span><span style=display:flex><span>        Start  Length  Slot  Name   Signature
</span></span><span style=display:flex><span>            8      47     2     i   I
</span></span><span style=display:flex><span>          106      42     7  info   Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>            0     164     0  args   <span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>            6     158     1 threads   <span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Thread<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>           72      92     2 threadMXBean   Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadMXBean<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>           81      83     3 threadInfo   <span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>      StackMapTable<span style=color:#ff79c6>:</span> number_of_entries <span style=color:#ff79c6>=</span> 5 <span style=color:#ff79c6>(</span>解释：会在虚拟机类加载的字节码验证阶段被新类型检查验证器使用<span style=color:#ff79c6>)</span>
</span></span><span style=display:flex><span>        frame_type <span style=color:#ff79c6>=</span> 253 <span style=color:#6272a4>/* append */</span>
</span></span><span style=display:flex><span>          offset_delta <span style=color:#ff79c6>=</span> 8
</span></span><span style=display:flex><span>          locals <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>[</span> <span style=color:#8be9fd;font-style:italic>class</span> &#34;[<span style=color:#50fa7b>Ljava</span><span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Thread<span style=color:#ff79c6>;</span><span style=color:#f1fa8c>&#34;, int ]
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        frame_type = 250 /* chop */
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>          offset_delta = 46
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        frame_type = 12 /* same */
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        frame_type = 255 /* full_frame */
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>          offset_delta = 23
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>          locals = [ class &#34;</span><span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>String<span style=color:#ff79c6>;</span><span style=color:#f1fa8c>&#34;, class &#34;</span><span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>Thread<span style=color:#ff79c6>;</span><span style=color:#f1fa8c>&#34;, class java/lang/management/ThreadMXBean, class &#34;</span><span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span><span style=color:#f1fa8c>&#34;, class &#34;</span><span style=color:#ff79c6>[</span>Ljava<span style=color:#ff79c6>/</span>lang<span style=color:#ff79c6>/</span>management<span style=color:#ff79c6>/</span>ThreadInfo<span style=color:#ff79c6>;</span><span style=color:#f1fa8c>&#34;, int, int ]
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>          stack = []
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        frame_type = 248 /* chop */
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>          offset_delta = 61
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>  public static void increase();
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    descriptor: ()V
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    flags: ACC_PUBLIC, ACC_STATIC
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Code:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>      stack=2, locals=0, args_size=0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         0: getstatic     #25                 // Field race:I
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         3: iconst_1
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         4: iadd
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         5: putstatic     #25                 // Field race:I
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         8: return
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>      LineNumberTable:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        line 45: 0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        line 46: 8
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>  public static void increaseB();
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    descriptor: ()V
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    flags: ACC_PUBLIC, ACC_STATIC
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Code:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>      stack=1, locals=0, args_size=0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         0: getstatic     #23                 // Field raceB:Ljava/util/concurrent/atomic/AtomicInteger;
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         3: invokevirtual #26                 // Method java/util/concurrent/atomic/AtomicInteger.incrementAndGet:()I
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         6: pop
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         7: return
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>      LineNumberTable:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        line 49: 0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        line 50: 7
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>  static {};
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    descriptor: ()V
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    flags: ACC_STATIC
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>    Code:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>      stack=3, locals=0, args_size=0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         0: iconst_0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         1: putstatic     #25                 // Field race:I
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         4: new           #27                 // class java/util/concurrent/atomic/AtomicInteger
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         7: dup
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         8: iconst_0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>         9: invokespecial #28                 // Method java/util/concurrent/atomic/AtomicInteger.&#34;</span><span style=color:#ff79c6>&lt;</span>init<span style=color:#ff79c6>&gt;</span><span style=color:#f1fa8c>&#34;:(I)V
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        12: putstatic     #23                 // Field raceB:Ljava/util/concurrent/atomic/AtomicInteger;
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        15: return
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>      LineNumberTable:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        line 40: 0
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>        line 42: 4
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>}
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>SourceFile: &#34;</span>VolatileDemo<span style=color:#ff79c6>.</span><span style=color:#50fa7b>java</span>&#34;
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>InnerClasses:</span>
</span></span><span style=display:flex><span>     <span style=color:#8be9fd;font-style:italic>static</span> #3<span style=color:#ff79c6>;</span> <span style=color:#6272a4>//class ctj/jvm/VolatileDemo$1
</span></span></span></code></pre></div><p>案例一：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>VolatileDemo</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#6272a4>/**
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * volatile 保证变量对所有线程的可见性  禁止指令重排序
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     * @param args
</span></span></span><span style=display:flex><span><span style=color:#6272a4>     */</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>String<span style=color:#ff79c6>[]</span> args<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        Thread<span style=color:#ff79c6>[]</span> threads <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Thread<span style=color:#ff79c6>[</span>10<span style=color:#ff79c6>];</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span> i <span style=color:#ff79c6>&lt;</span> threads<span style=color:#ff79c6>.</span><span style=color:#50fa7b>length</span><span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>++)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            threads<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>]</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Thread<span style=color:#ff79c6>(</span><span style=color:#ff79c6>new</span> Runnable<span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>                @Override
</span></span><span style=display:flex><span>                <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>run</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span> j <span style=color:#ff79c6>&lt;</span> 10000<span style=color:#ff79c6>;</span> j<span style=color:#ff79c6>++)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>                        increase<span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>                    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>                <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>});</span>
</span></span><span style=display:flex><span>            threads<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>].</span><span style=color:#50fa7b>start</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>threads<span style=color:#ff79c6>[</span>i<span style=color:#ff79c6>].</span><span style=color:#50fa7b>getName</span><span style=color:#ff79c6>());</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>while</span> <span style=color:#ff79c6>(</span>Thread<span style=color:#ff79c6>.</span><span style=color:#50fa7b>activeCount</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>&gt;</span> 2<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            Thread<span style=color:#ff79c6>.</span><span style=color:#50fa7b>yield</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>        ThreadMXBean threadMXBean <span style=color:#ff79c6>=</span> ManagementFactory<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getThreadMXBean</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        ThreadInfo<span style=color:#ff79c6>[]</span> threadInfo <span style=color:#ff79c6>=</span> threadMXBean<span style=color:#ff79c6>.</span><span style=color:#50fa7b>dumpAllThreads</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>false</span><span style=color:#ff79c6>,</span> <span style=color:#ff79c6>false</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span>ThreadInfo info <span style=color:#ff79c6>:</span> threadInfo<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;[&#34;</span> <span style=color:#ff79c6>+</span> info<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getThreadId</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>+</span> <span style=color:#f1fa8c>&#34;]&#34;</span> <span style=color:#ff79c6>+</span> info<span style=color:#ff79c6>.</span><span style=color:#50fa7b>getThreadName</span><span style=color:#ff79c6>());</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>race<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd;font-style:italic>volatile</span> <span style=color:#8be9fd>int</span> race <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>increase</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        race<span style=color:#ff79c6>++;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span> 
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>上述命令中的 System.out.println(race); 的输出结果是什么？结果不确定。</p><pre tabindex=0><code>/* Thread-0
* Thread-1
* Thread-2
* Thread-3
* Thread-4
* Thread-5
* Thread-6
* Thread-7
* Thread-8
* Thread-9
* [6]Monitor Ctrl-Break MonitorCtrl-Break 线程 主要功能是 1.Lock Information in Thread Dumps 2.DetectingDeadlocks
* [5]Attach Listener   Attach Listener线程是负责接收到外部的命令而对该命令进行执行的并且吧结果返回给发送者
* [4]SignalDispatcher   Attach Listener当命令接收成功后会交给signaldispather线程去进行分发到各个不同的模块处理命令 并且返回处理结果
* [3]Finalizer 在main线程之后创建的 其优先级为10 主要用于在垃圾收集前调用对象的finalize()方法
* [2]Reference Handler  VM在创建main线程后就创建ReferenceHandler线程 其优先级最高 为10 它主要用于处理引用对象本身（软引用、弱引用、虚引用）的垃圾回收问题
* [1]main 主线程
*/
</code></pre><p>解决方案：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd;font-style:italic>volatile</span> <span style=color:#8be9fd>int</span> race <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>increase</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    race<span style=color:#ff79c6>++;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>将以上代码替换为以下代码，能够成功解决并发原子性自增问题</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> AtomicInteger raceB <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> AtomicInteger<span style=color:#ff79c6>(</span>0<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>increaseB</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    raceB<span style=color:#ff79c6>.</span><span style=color:#50fa7b>incrementAndGet</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p>案例二：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>StackOverflowError</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>private</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>int</span> count<span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>count</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>try</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            count<span style=color:#ff79c6>++;</span>
</span></span><span style=display:flex><span>            count<span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>catch</span> <span style=color:#ff79c6>(</span>Throwable e<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;最大深度:&#34;</span> <span style=color:#ff79c6>+</span> count<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>            e<span style=color:#ff79c6>.</span><span style=color:#50fa7b>printStackTrace</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>String<span style=color:#ff79c6>[]</span> args<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        count<span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p><img src=/images/2019-08-18-java-jvm/6.jpeg alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>RuntimeConstantOOM</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>String<span style=color:#ff79c6>[]</span> args<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4>/**
</span></span></span><span style=display:flex><span><span style=color:#6272a4>         * -XX:PermSize=10M -XX:MaxPermSize=10M
</span></span></span><span style=display:flex><span><span style=color:#6272a4>         * JDK1.7之前就会抛错
</span></span></span><span style=display:flex><span><span style=color:#6272a4>         * JDK1.7之后循环一直进行下去 JDK1.8已经不存在上述配置
</span></span></span><span style=display:flex><span><span style=color:#6272a4>         */</span>
</span></span><span style=display:flex><span>        String str <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> StringBuilder<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;啊啊&#34;</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>append</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;哈哈&#34;</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>toString</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>str<span style=color:#ff79c6>.</span><span style=color:#50fa7b>intern</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>==</span> str<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        String str2 <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> StringBuilder<span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;ja&#34;</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>append</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;va&#34;</span><span style=color:#ff79c6>).</span><span style=color:#50fa7b>toString</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span>str2<span style=color:#ff79c6>.</span><span style=color:#50fa7b>intern</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>==</span> str2<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p><img src=/images/2019-08-18-java-jvm/7.jpeg alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>class</span> <span style=color:#50fa7b>HeapOutMemory</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd;font-style:italic>static</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>main</span><span style=color:#ff79c6>(</span>String<span style=color:#ff79c6>[]</span> args<span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#6272a4>// -Xms1m -Xmx10m -XX:+PrintGCDetails -XX:+HeapDumpOnOutOfMemoryError
</span></span></span><span style=display:flex><span><span style=color:#6272a4></span>        List<span style=color:#ff79c6>&lt;</span>Object<span style=color:#ff79c6>&gt;</span> listObject <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> ArrayList<span style=color:#ff79c6>&lt;&gt;();</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>for</span> <span style=color:#ff79c6>(</span><span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> 0<span style=color:#ff79c6>;</span> i <span style=color:#ff79c6>&lt;</span> 100<span style=color:#ff79c6>;</span> i<span style=color:#ff79c6>++)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;i:&#34;</span> <span style=color:#ff79c6>+</span> i<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>            Byte<span style=color:#ff79c6>[]</span> bytes <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>new</span> Byte<span style=color:#ff79c6>[</span>1 <span style=color:#ff79c6>*</span> 1024 <span style=color:#ff79c6>*</span> 1024<span style=color:#ff79c6>*</span>1024<span style=color:#ff79c6>];</span>
</span></span><span style=display:flex><span>            listObject<span style=color:#ff79c6>.</span><span style=color:#50fa7b>add</span><span style=color:#ff79c6>(</span>bytes<span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>        System<span style=color:#ff79c6>.</span><span style=color:#50fa7b>out</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>println</span><span style=color:#ff79c6>(</span><span style=color:#f1fa8c>&#34;添加成功...&#34;</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span></code></pre></div><p><img src=/images/2019-08-18-java-jvm/8.jpeg alt></p><p>bug 寻找之一起实战故障处理工具。</p><p><img src=/images/2019-08-18-java-jvm/9.jpeg alt>
<img src=/images/2019-08-18-java-jvm/10.jpeg alt>
<img src=/images/2019-08-18-java-jvm/11.jpeg alt>
<img src=/images/2019-08-18-java-jvm/12.jpeg alt></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>close</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>dataSource</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        Pool<span style=color:#ff79c6>&lt;</span>Jedis<span style=color:#ff79c6>&gt;</span> pool <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>dataSource</span><span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>dataSource</span> <span style=color:#ff79c6>=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>client</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>isBroken</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            pool<span style=color:#ff79c6>.</span><span style=color:#50fa7b>returnBrokenResource</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>else</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            pool<span style=color:#ff79c6>.</span><span style=color:#50fa7b>returnResource</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>else</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8be9fd;font-style:italic>super</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>close</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#8be9fd>void</span> <span style=color:#50fa7b>close</span><span style=color:#ff79c6>()</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>dataSource</span> <span style=color:#ff79c6>!=</span> <span style=color:#ff79c6>null</span><span style=color:#ff79c6>)</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> <span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>client</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>isBroken</span><span style=color:#ff79c6>())</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>dataSource</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>returnBrokenResource</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>else</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>dataSource</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>returnResource</span><span style=color:#ff79c6>(</span><span style=color:#ff79c6>this</span><span style=color:#ff79c6>);</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span> <span style=color:#ff79c6>else</span> <span style=color:#ff79c6>{</span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>this</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>client</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>close</span><span style=color:#ff79c6>();</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>}</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;</span>dependency<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;</span>groupId<span style=color:#ff79c6>&gt;</span>redis<span style=color:#ff79c6>.</span><span style=color:#50fa7b>clients</span><span style=color:#ff79c6>&lt;/</span>groupId<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;</span>artifactId<span style=color:#ff79c6>&gt;</span>jedis<span style=color:#ff79c6>&lt;/</span>artifactId<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#ff79c6>&lt;</span>version<span style=color:#ff79c6>&gt;</span>2<span style=color:#ff79c6>.</span><span style=color:#50fa7b>9</span><span style=color:#ff79c6>.</span><span style=color:#50fa7b>2</span><span style=color:#ff79c6>&lt;/</span>version<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&lt;/</span>dependency<span style=color:#ff79c6>&gt;</span>
</span></span></code></pre></div><p>比较差异得出释放资源不同。</p><p>总的来说，Java JVM 是Java语言的核心运行时环境，为Java应用程序提供了跨平台性、内存管理、多线程支持和安全性等重要功能。JVM的即时编译技术和垃圾回收器使得Java应用程序既能保持高效执行，又能避免手动内存管理的复杂性。因此，JVM在Java生态系统中扮演着至关重要的角色，使得Java成为广泛应用于企业和互联网领域的强大编程语言。</p><hr><ul class=pager><li class=previous><a href=/post/2019-02-05-happy-new-year/ data-toggle=tooltip data-placement=top title="2019 新年快乐（Happy New Year）">&larr;
Previous Post</a></li><li class=next><a href=/post/2020-03-14-cka-practice/ data-toggle=tooltip data-placement=top title="高效通过 Kubernetes CKAD 考试">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:tanjunchen20@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=/img/wechat.jpg><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-weixin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/tanjunchen><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; 陈谭军 2023<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://github.com/tanjunchen>tanjunchen</a></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>